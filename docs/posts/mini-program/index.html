<!DOCTYPE html><html lang="zh-cn"><head><meta charset="UTF-8"><title>Mini-Program | World of Forks</title><meta name="viewport" content="width=device-width,user-scalable=no,maximum-scale=1,initial-scale=1"><link rel="canonical" href="https://kricsleo.github.io/docs/posts/mini-program/"><link href="https://fonts.cat.net/icon?family=Material+Icons" rel="stylesheet"><link href="//cdn.bootcss.com/highlight.js/9.12.0/styles/ocean.min.css" rel="stylesheet"><link rel="stylesheet" href="https://kricsleo.github.io/docs/css/index-38f2e5a4cb.css"><link href="https://kricsleo.github.io/docs/index.xml" rel="alternate" type="application/rss+xml" title="World of Forks"><link href="https://kricsleo.github.io/docs/index.xml" rel="feed" type="application/rss+xml" title="World of Forks"><link href="https://kricsleo.github.io/docs/favicon.ico" rel="shortcut icon"><script>window.baseURL = 'https:\/\/kricsleo.github.io\/docs';</script></head><body><div class="navbar-fixed"><nav class="navbar"><div class="nav-container container"><div class="nav-wrapper inner"><a href="javascript:void(0)" data-activates="sidebar" class="button-collapse hide-on-large-only"><i class="material-icons">menu</i> </a><a href="https://kricsleo.github.io/docs" class="brand-logo"><i class="material-icons hide-on-med-and-down">restaurant_menu</i> World of Forks</a><ul class="nav-menu tabs tabs-transparent hide-on-med-and-down"><li class="tab"><a href="https://kricsleo.github.io/docs/docs/" class="">Home</a></li><li class="tab"><a href="https://kricsleo.github.io/docs/docs/archive/" class="">Archive</a></li><li class="tab"><a href="https://kricsleo.github.io/docs/docs/about/" class="">About</a></li></ul><form class="nav-form hide-on-small-and-down"><div class="form-group"><i class="material-icons">search</i> <input type="text" placeholder="输入搜索关键字"></div><div class="form-popout"><div class="search-result"><label>暂无搜索结果</label><ul></ul></div></div></form><ul class="nav-menu apps"><li><a class="search-btn hide-on-med-and-up" href="#search-panel"><i class="material-icons">search</i></a></li><li><a class="term-btn hide-on-small-and-down" href="#term-panel"><i class="material-icons">apps</i></a></li><li><a class="rss-btn hide-on-small-and-down" href="https://kricsleo.github.io/docs/index.xml" target="_blank"><i class="material-icons">rss_feed</i></a></li></ul></div></div></nav></div><div class="mobile-search hide-on-med-and-up"><div class="header"><i class="material-icons">search</i> <input type="text" placeholder="输入搜索关键字"> <i class="material-icons mobile-search-close">cancel</i></div><div class="content"><label>暂无搜索结果</label><ul></ul></div></div><div class="taxonomy"><div class="container"><div class="inner"><div class="taxonomy-panel"><div class="group"><label>Category</label><ul><li><a class="btn btn-secondary" href="https://kricsleo.github.io/docs/categories/tools">tools <span class="badge">3</span></a></li><li><a class="btn btn-secondary" href="https://kricsleo.github.io/docs/categories/%E5%89%8D%E7%AB%AF">前端 <span class="badge">3</span></a></li></ul></div><div class="group"><label>Tag</label><ul><li><a class="btn btn-secondary" href="https://kricsleo.github.io/docs/tags/encrypt">encrypt <span class="badge">2</span></a></li><li><a class="btn btn-secondary" href="https://kricsleo.github.io/docs/tags/codestyle">codestyle <span class="badge">1</span></a></li><li><a class="btn btn-secondary" href="https://kricsleo.github.io/docs/tags/funtion">funtion <span class="badge">1</span></a></li><li><a class="btn btn-secondary" href="https://kricsleo.github.io/docs/tags/git">git <span class="badge">1</span></a></li><li><a class="btn btn-secondary" href="https://kricsleo.github.io/docs/tags/github">github <span class="badge">1</span></a></li><li><a class="btn btn-secondary" href="https://kricsleo.github.io/docs/tags/javascript">javascript <span class="badge">1</span></a></li><li><a class="btn btn-secondary" href="https://kricsleo.github.io/docs/tags/markdown">markdown <span class="badge">1</span></a></li><li><a class="btn btn-secondary" href="https://kricsleo.github.io/docs/tags/mini-program">mini-program <span class="badge">1</span></a></li><li><a class="btn btn-secondary" href="https://kricsleo.github.io/docs/tags/ssh">ssh <span class="badge">1</span></a></li></ul></div></div></div></div></div><ul class="side-nav" id="sidebar"><li><a href="https://kricsleo.github.io/docs/docs/" class="">Home</a></li><li><a href="https://kricsleo.github.io/docs/docs/archive/" class="">Archive</a></li><li><a href="https://kricsleo.github.io/docs/docs/about/" class="">About</a></li><li><a class="term-btn-mobile hide-on-med-only" href="https://kricsleo.github.io/docs/categories/">Categories</a></li><li><a class="term-btn-mobile hide-on-med-only" href="https://kricsleo.github.io/docs/tags/">Tags</a></li><li><a class="rss-btn-mobile hide-on-med-only" href="https://kricsleo.github.io/docs/index.xml" target="_blank">Rss</a></li></ul><main id="single" role="main" class="main-panel"><div class="page-content"><div class="container container-ex"><div class="inner"><section class="post-wrapper"><div class="toc-panel"><nav id="TableOfContents"><ul><li><a href="#微信小程序跳坑记录">微信小程序跳坑记录</a><ul><li><a href="#数据绑定">数据绑定</a></li><li><a href="#生命周期">生命周期</a></li><li><a href="#组件">组件</a></li><li><a href="#request">request</a></li></ul></li></ul></nav></div><div class="post reveal"><div class="card"><section class="breadcrumb-root"><div class="breadcrumbs" role="navigation" aria-label="breadcrumbs navigation"><a class="breadcrumb" href="https://kricsleo.github.io/docs"><i class="material-icons">location_on</i>Home</a> <span class="breadcrumb">Mini-Program</span></div></section><div class="card-header postinfo"><span class="card-title">Mini-Program</span></div><div class="card-header date"><div class="group"><i class="material-icons">book</i><address>归档： <a href="https://kricsleo.github.io/docs/categories/%E5%89%8D%E7%AB%AF">前端</a>&nbsp;</address></div><div class="group"><i class="material-icons">flag</i> <time>创建：2018年09月 6日</time></div></div><div class="card-content"><article class="article"><h1 id="微信小程序跳坑记录">微信小程序跳坑记录</h1><p>开发微信小程序还是踩了不少坑的, 官方的文档并不详细, 更新也不及时, 碰到问题还是多google吧.</p><!-- more --><h2 id="数据绑定">数据绑定</h2><p>微信小程序通过<code>状态模式-单向数据流</code>来实现数据绑定.<br>状态模式定义一个对象, 当对象发生改变时, 状态就发生改变, 然后通知与之绑定的视图刷新, 注意: <strong>数据流向是单向的, 即视图变化不会引起对象状态变化</strong>.<br>如果想要视图改变的时候让对象状态也一并改变, 那么就需要依赖事件来实现, 即视图变化 -&gt; 触发事件 -&gt; 捕获事件 -&gt; 回调处理(在这里可以操作对象)</p><h2 id="生命周期">生命周期</h2><p>一个页面要正常显示，必须经历以上3个生命周期：<code>加载</code> -&gt; <code>显示</code> -&gt; <code>渲染</code>, 对应回调函数顺序:<code>onLoad</code> -&gt; <code>onShow</code> -&gt; <code>onReady</code>.<br>官方给出的示例中<code>onReady</code>放在<code>onShow</code>之前, 但是这并不是真正的顺序, 容易误导开发者</p><h2 id="组件">组件</h2><ol><li>hidden属性<br>有时候想要通过组件的<code>hidden</code>属性来控制某个组件不显示, 但是<code>hidden=&quot;true&quot;</code>在遇到你已经设置过<code>display: flex;</code>的组件时是不会生效的, 原因是<code>hidden=&quot;true&quot;</code>实际上就是会设置组件的css属性<code>display: &quot;none&quot;;</code>, 二者冲突导致覆盖然后<code>hidden</code>不生效, 如果设置为<code>display: block;</code>变成块状布局就可以正常使用该属性.<br>或者采取如下解决方案:<br><code>html &lt;view style=&quot;display: {{isHidden ? 'none' : 'flex'}};&quot;&gt;&lt;/view&gt;</code><br>当然最好的办法就是别去用这个有坑的属性.<br><br></li></ol><ul class="task-list"><li><label><input type="checkbox" disabled="disabled" class="task-list-item"> TODO: 测试是否如此<br><br></label></li></ul><p>对于不怎么切换显示隐藏的组件可以使用<code>wx:if</code>, 这样的渲染支出是可以接受的, 但是如果一个组件会经常的切换显示隐藏, 那么最好考虑采取<code>display: &quot;none;&quot;</code>的方法, 因为这样不需要重复渲染组件, 只要切换显示隐藏即可, 可以减少cpu支出, 提高页面效率. <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/conditional.html">官方说法</a></p><ol><li><p>scroll-view<br>注意：使用竖向滚动时，需要给<code>scroll-view</code>一个固定高度, 否则无法<code>点击回到顶部</code>以及<code>滚动到指定位置</code></p></li><li><p>text<br><code>text</code>组件内只支持嵌套<code>text</code></p></li></ol><h2 id="request">request</h2><p><code>GET</code>一般都正常, 但是<code>POST</code>请求真可谓是&rsquo;一千个读者有一千个哈姆雷特&rsquo;, 各种失败的情况都有, 可尝试如下方法:</p><ol><li>首先<code>method</code>是必须设置为<code>POST</code>的;<br></li><li><code>header</code>中设置<code>&quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded&quot;</code>, 也有说小写<code>&quot;content-type&quot;: &quot;application/x-www-form-urlencoded&quot;</code>能成功;<br></li><li>data有说不能直接传<code>json</code>格式, 需要先转格式:<br>```JavaScript<br>function json2Form(json) {<br>var str = [];<br>for(var p in json){<br>str.push(encodeURIComponent(p) + &ldquo;=&rdquo; + encodeURIComponent(json[p]));<br>}<br>return str.join(&rdquo;&amp;&ldquo;);<br>}<br><br></li></ol><p>let data = {<br>name: &lsquo;张三&rsquo;,<br>age: &lsquo;23&rsquo;<br>};</p><p>const ajaxData = json2Form(data); // 然后将<code>ajaxData</code>附在请求的<code>data</code>中字段中<br>```</p><ol><li>也有说服务端必须是<code>https</code>的;<br></li><li>实在不行服务端就改成<code>GET</code>吧&hellip;<br></li></ol></article></div><div class="card-action card-action-links"><a class="btn btn-secondary" href="https://kricsleo.github.io/docs/tags/mini-program">Mini Program</a></div><div class="card-action"><div id="comment"></div><style>.v .vwrap .vheader .vinput:focus {
    border-bottom-color: #607d8b;
  }</style><script>window.VALINECONFIG = {
    el: '#comment',
    notify: false,
    verify: false,
    appId: 'drenIDLMO3yTwiuCl7Hva9nq-gzGzoHsz',
    appKey: 'rfotKaw6cevwHhOR8FvhwPAp',
    placeholder: '写点什么吧...',
    path: window.location.pathname,
    avatar: 'retro'
  }</script></div><div class="pagination-single"><span class="pagination-item previous"><i class="material-icons">navigate_before</i> <a href="https://kricsleo.github.io/docs/posts/practical-function-in-javascript/" rel="prev">Practical-Function-In-Javascript</a> </span><span class="pagination-item next"><a href="https://kricsleo.github.io/docs/posts/unicode-utf8/" rel="next">ASCII-Unicode-UTF8</a> <i class="material-icons">navigate_next</i></span></div></div></div></section></div></div></div><footer class="page-footer"><div class="container"><div class="inner"><div class="wrapper"><div class="group group-slink"><h5>World of Forks</h5><p>Theme <a href="https://github.com/stkevintan/canoe" target="_blank">canoe</a> designed by <a href="https://github.com/stkevintan" target="_blank">Kevin Tan</a> with ❤</p><ul class="slink"><li><a href="https://github.com/stkevintan" target="_blank" title="Github"><svg class="svg-icons svg-icons-github"><use xlink:href="#svg-icons-github"></use></svg></a></li><li><a href="https://twitter.com/kevinsfork" target="_blank" title="Twitter"><svg class="svg-icons svg-icons-twitter"><use xlink:href="#svg-icons-twitter"></use></svg></a></li><li><a href="http://weibo.com/kevinclasky" target="_blank" title="Weibo"><svg class="svg-icons svg-icons-sina-weibo"><use xlink:href="#svg-icons-sina-weibo"></use></svg></a></li></ul></div><div class="group group-flink"><h5>My Friends</h5><ul><li><a href="https://frantic1048.logdown.com/" target="_blank">Frantic1048</a></li><li><a href="https://hclmaster.github.io/" target="_blank">HclMaster</a></li><li><a href="https://whst.github.io/" target="_blank">WANG Hsü-Tung</a></li></ul></div></div></div></div><div class="footer-copyright"><div class="container"><div class="inner">Copyleft@Kevin Tan</div></div></div></footer></main><script type="text/javascript" async src="//cdn.bootcss.com/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script><script type="text/javascript" src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script><script src="https://cdn.bootcss.com/highlight.js/9.12.0/languages/go.min.js"></script><script src="https://cdn.bootcss.com/highlight.js/9.12.0/languages/typescript.min.js"></script><script>hljs.configure({
    tabReplace: '  '
  })
  hljs.registerLanguage("graphql", function (e) { return { aliases: ["gql"], k: { keyword: "query mutation subscription|10 type interface union scalar fragment|10 enum on ...", literal: "true false null" }, c: [e.HCM, e.QSM, e.NM, { cN: "type", b: "[^\\w][A-Z][a-z]", e: "\\W", eE: !0 }, { cN: "literal", b: "[^\\w][A-Z][A-Z]", e: "\\W", eE: !0 }, { cN: "variable", b: "\\$", e: "\\W", eE: !0 }, { cN: "keyword", b: "[.]{2}", e: "\\." }, { cN: "meta", b: "@", e: "\\W", eE: !0 }], i: /([;<']|BEGIN)/ } });
  hljs.initHighlightingOnLoad();</script><script type="text/javascript" src="https://kricsleo.github.io/docs/js/polyfill-7b0f9ccd98.js"></script><script type="text/javascript" src="https://kricsleo.github.io/docs/js/index-e16d25bc2c.js"></script><script src="/service-worker.js"></script><script>if ('serviceWorker' in navigator) {
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('/service-worker.js').then(function(reg) {
      reg.onupdatefound = function() {
        var installingWorker = reg.installing;
        installingWorker.onstatechange = function() {
          switch (installingWorker.state) {
            case 'installed':
              if (navigator.serviceWorker.controller) {
                console.log('New or updated content is available.');
              } else {
                console.log('Content is now available offline!');
              }
              break;
            case 'redundant':
              console.error('The installing service worker became redundant.');
              break;
          }
        };
      };
    }).catch(function(e) {
      console.error('Error during service worker registration:', e);
    });
  });
}</script></body></html>